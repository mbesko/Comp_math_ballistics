# Симуляция полёта снаряда

Данный проект представляет собой компьютерную симуляцию полёта снаряда (шара) с реалистичной динамикой. В модели учтены:
- **Гравитация**
- **Аэродинамическое сопротивление воздуха**
- **Влияние ветра**
- **Отскок от поверхности** (с учетом коэффициента восстановления)

Симуляция реализована на языке Python с использованием библиотеки pygame. Все численные интеграции выполнены вручную, без применения готовых решателей ODE.

## Методы интегрирования

В задаче используются два метода численного интегрирования системы дифференциальных уравнений:

- **RK4 (Метод Рунге–Кутты 4-го порядка)**  
  При каждом шаге рассчитывается:
  \[
  \begin{aligned}
  k_1 &= f(\mathbf{y}(t)) \\
  k_2 &= f\Big(\mathbf{y}(t) + \frac{\Delta t}{2}\, k_1\Big) \\
  k_3 &= f\Big(\mathbf{y}(t) + \frac{\Delta t}{2}\, k_2\Big) \\
  k_4 &= f\Big(\mathbf{y}(t) + \Delta t\, k_3\Big) \\
  \mathbf{y}(t+\Delta t) &\approx \mathbf{y}(t) + \frac{\Delta t}{6}\left(k_1 + 2k_2 + 2k_3 + k_4\right)
  \end{aligned}
  \]
  где \( \mathbf{y}(t) = [x,\, y,\, v_x,\, v_y] \) – вектор состояния.

- **Dormand–Prince (Dopri5)**  
  Этот метод является разновидностью методов Рунге–Кутты с адаптивным выбором шага (в нашем случае реализована фиксированная версия). Он использует 7 промежуточных оценок \( k_1, \dots, k_7 \) с соответствующими коэффициентами из таблицы Бутчера:
  \[
  \mathbf{y}(t+\Delta t) \approx \mathbf{y}(t) + \Delta t \left(b_1 k_1 + b_2 k_2 + \dots + b_7 k_7\right)
  \]
  где коэффициенты \( a_{ij} \) и \( b_i \) задают вклад каждого этапа, обеспечивая высокую точность интегрирования.

## Физическая модель и дифференциальные уравнения

Симуляция описывается системой обыкновенных дифференциальных уравнений (ОДУ), которые вытекают из второго закона Ньютона:

- **Уравнения движения:**
  \[
  \frac{dx}{dt} = v_x, \quad \frac{dy}{dt} = v_y
  \]
  \[
  \frac{dv_x}{dt} = a_{drag,x}
  \]
  \[
  \frac{dv_y}{dt} = -g + a_{drag,y}
  \]
  
- **Сила сопротивления воздуха (аэродинамическое сопротивление):**

  Сила сопротивления рассчитывается по формуле:
  \[
  \mathbf{F}_{\text{drag}} = -\frac{1}{2}\, C_d\, \rho\, A\, |\mathbf{v}_{\text{rel}}|\, \hat{\mathbf{v}}_{\text{rel}}
  \]
  где:
  - \( C_d \) — коэффициент аэродинамического сопротивления,
  - \( \rho \) — плотность воздуха,
  - \( A = \pi r^2 \) — площадь поперечного сечения снаряда (радиус \( r \)),
  - \( \mathbf{v}_{\text{rel}} = \mathbf{v} - \mathbf{v}_{\text{wind}} \) — относительная скорость снаряда относительно ветра,
  - \( |\mathbf{v}_{\text{rel}}| \) — модуль относительной скорости,
  - \( \hat{\mathbf{v}}_{\text{rel}} \) — единичный вектор, направленный вдоль \(\mathbf{v}_{\text{rel}}\).

  После деления силы на массу \( m \) получаем ускорение от сопротивления:
  \[
  \mathbf{a}_{\text{drag}} = -\frac{1}{2m}\, C_d\, \rho\, A\, |\mathbf{v}_{\text{rel}}|\, \mathbf{v}_{\text{rel}}
  \]

- **Гравитация:**  
  Ускорение свободного падения \( g \) действует вертикально вниз, поэтому его вклад в уравнение для \( v_y \) равен \(-g\).

## Особенности реализации

- **Ручная реализация методов интегрирования.**  
  Все расчеты производятся самостоятельно: как метод RK4, так и метод Dormand–Prince реализованы без использования готовых решателей типа `odeint` или `solve_ivp`.

- **Параметры модели.**  
  Изменяемые параметры (размер снаряда, масса, угол выстрела, сила выстрела, высота пушки, скорость и направление ветра) задаются в словаре `params`. Это позволяет легко настраивать симуляцию.

- **Отскок от поверхности.**  
  При достижении снарядом земли (y ≤ 0) реализован отскок с изменением направления вертикальной скорости с учетом коэффициента восстановления.

- **Визуализация и сравнение методов.**  
  С помощью библиотеки pygame отображается 2D-анимация траекторий, полученных методами RK4 и Dormand–Prince. Также рассчитывается и выводится разница (ошибка) между положениями, полученными двумя методами.
